---
export const prerender = true;

import { Picture } from "astro:assets";
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout>
  <div class="mx-auto flex w-full flex-col gap-8 pb-8">
    <div class="grid gap-8 md:grid-cols-2">
      {
        posts.map((post) => {
          const formattedTime = new Intl.DateTimeFormat("pl").format(
            post.data.pubDate
          );

          return (
            <a
              href={"/blog/" + post.id}
              class="transition-transform duration-300 lg:hover:scale-[0.99] lg:focus:scale-[0.98]">
              <article class="glass flex min-h-42 flex-col justify-between gap-4 overflow-hidden md:flex-row">
                <header class="flex flex-col gap-1">
                  <h2 class="text-foreground z-20 text-lg font-semibold text-pretty lg:text-xl">
                    {post.data.title}
                  </h2>
                  <p class="before:bg-background/90 relative text-base font-semibold before:absolute before:top-0 before:left-0 before:-z-10 before:h-full before:w-full before:blur-lg lg:text-base">
                    <time datetime={formattedTime}>{formattedTime}</time>
                  </p>
                  <p class="z-20 text-base text-pretty lg:max-w-[28rem] lg:text-sm">
                    {post.data.description}
                  </p>
                </header>
                <Picture
                  src={post.data.heroImage}
                  width={256}
                  height={256}
                  alt={post.data.title}
                  class="border-foreground/30 hidden h-32 w-32 rounded-lg border md:block"
                />
              </article>
            </a>
          );
        })
      }
    </div>
  </div>
</Layout>
