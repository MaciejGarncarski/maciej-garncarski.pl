---
import { Image } from "astro:assets";
import clsx from "clsx";
import logoIcon from "../assets/logoIcon.png";
import Picture from "astro/components/Picture.astro";

type Link = {
  url: string;
  text: string;
};

const navigationData: Array<Link> = [
  {
    text: "O mnie",
    url: "/"
  },
  {
    text: "Projekty",
    url: "/projekty"
  },
  {
    text: "Blog",
    url: "/blog"
  }
];

const pathname = Astro.url.pathname.replace(import.meta.env.BASE_URL, "");
const subpath = pathname.match(/[^/]+/g);
---

<nav class="flex items-center justify-start px-0.5">
  <a href="/">
    <Picture
      formats={["avif", "webp"]}
      src={logoIcon}
      alt="M"
      height={40}
      width={40}
      class={"size-10"}
    />
    <span class="sr-only">Strona główna</span>
  </a>
  <ul
    class="ml-auto flex gap-x-4 gap-y-4 tracking-tight lg:gap-x-8"
    transition:name="nav-menu">
    {
      navigationData.map((n) => {
        const isActive =
          n.url === pathname || n.url === "/" + (subpath?.[0] || "");

        const isBlogPage = n.url === "/blog/";

        const isBlogPageActive =
          isBlogPage && Astro.url.pathname.startsWith("/blog/");

        return (
          <li>
            <a
              href={n.url}
              class={clsx(
                "rounded-md px-2 py-1 md:text-lg lg:px-3",
                isActive || isBlogPageActive
                  ? "bg-foreground text-background"
                  : ""
              )}>
              {n.text}
            </a>
          </li>
        );
      })
    }
  </ul>
</nav>
